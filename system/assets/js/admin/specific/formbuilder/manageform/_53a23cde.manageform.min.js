!function(a){var b,c,d,e,f,g,h,i,j,k,l=a(".formbuilder-item-type-picker .item-type"),m=a(".form-items"),n=a(".instructions"),o=cfrequest.formbuilderFormId,p=cfrequest.formbuilderSaveNewItemEndpoint,q=cfrequest.formbuilderSaveItemEndpoint,r=cfrequest.formbuilderDeleteItemEndpoint;b=function(){l.draggable({helper:"clone",connectToSortable:m}),n.droppable({accept:l,drop:d}),m.sortable({stop:e,placeholder:"item-type sortable-placeholder",handle:".sort-link"})},c=function(){m.on("click",".edit-link",j),m.on("click",".delete-link",k)},d=function(a,b){var c=b.draggable.clone();c.appendTo(m),n.removeClass("empty"),f(c)},e=function(a,b){var c=b.item,d=c.data();d.itemTemplate&&(f(c),c.data("itemTemplate",!1))},f=function(a){var b=a.data();b.requiresConfiguration?i(a):g(b.itemType,{},a)},g=function(b,c,d){var e,f=a.extend({},{formId:o,itemType:b},c);e=function(b){var c=a(b.itemView);d.after(c),d.remove()},a.ajax(p,{method:"POST",data:f,cache:!1,success:e})},h=function(b,c){var d,e=a.extend({},{id:c.data("id")},b);d=function(b){var d=a(b.itemView);c.after(d),c.remove()},a.ajax(q,{method:"POST",data:e,cache:!1,success:d})},i=function(a){var b,c,d,e,f,i=a.data();d=function(){return f.validateFormBuilderItemConfig(o,i.id||"",function(b){if(b){var c=f.getFormBuilderItemConfig();"undefined"==typeof i.id?g(i.itemType,c,a):h(c,a),e.close()}}),!1},b=function(){var b=a.data();"undefined"==typeof b.id&&a.remove()},c=function(a){f=a},e=new PresideIframeModal(i.configEndpoint,"100%","100%",{onLoad:c,onok:d,oncancel:b},{title:i.configTitle,className:"full-screen-dialog",buttonList:["ok","cancel"]}),e.open()},j=function(b){var c=a(this),d=c.closest(".form-item");b.preventDefault(),i(d)},k=function(b){var c=a(this),d=c.closest(".form-item"),e=c.data("title")||c.attr("title"),f=i18n.translateResource("cms:confirmation.prompt",{data:[e.charAt(0).toLowerCase()+e.slice(1)]});b.preventDefault(),presideBootbox.confirm(f,function(b){b&&a.ajax(r,{method:"POST",data:{id:d.data("id")},cache:!1,success:function(a){a&&d.remove()}})})},b(),c()}(presideJQuery);
//# sourceMappingURL=_manageform.min.map