!function(a){var b=function(b){return a.inArray(b.nodeName,["A","INPUT","BUTTON","TEXTAREA","SELECT"])>=0||a(b).parents("a:first,input:first,button:first,textarea:first,select:first").length};a("body").on("click",".page-type-picker .page-type",function(c){if(!b(c.target)){var d=a(this).find("a:first");d.length&&(c.preventDefault(),d.get(0).click())}})}(presideJQuery),function(a){a.fn.treeTable=function(){var b,c,d,e,f,g,h='<tr class="depth-{{depth}} ajax-loading" data-parent="{{parent}}" data-depth="{{depth}}"><td colspan="5">'+i18n.translateResource("cms:sitetree.ajax.loading.message")+"</td></tr>",i='<tr class="depth-{{depth}} ajax-loading-error" data-parent="{{parent}}" data-depth="{{depth}}"><td colspan="5"><i class="fa fa-fw fa-exclamation-circle red"></i> '+i18n.translateResource("cms:sitetree.ajax.loading.error.message")+"</td></tr>";return b=function(c){var d=g(c);d.show().each(function(){var c=a(this);g(c).length&&c.data("open")&&b(c)}),c.data("childrenLoaded")||c.data("childrenLoading")||f(c)},f=function(b){b.data("childrenLoading",!0);var c,d,e,f=g(b),j=a(Mustache.render(h,{depth:parseInt(b.data("depth"))+1,parent:b.data("id")}));f.length?a(f.get(f.length-1)).after(j):b.after(j),b.data("children",calculateChildren(b)),c=function(a){j.before(a)},d=function(){var c=a(Mustache.render(i,{depth:parseInt(b.data("depth"))+1,parent:b.data("id")}));j.before(c)},e=function(){j.remove(),b.data("childrenLoaded",!0),b.data("childrenLoading",!1),b.data("children",calculateChildren(b)),g(b).attr("tabindex",b.attr("tabindex"))},a.ajax(buildAjaxLink("sitetree.ajaxChildNodes",{parentId:b.data("id")}),{method:"GET",cache:!1,success:c,error:d,complete:e})},calculateChildren=function(a){var b=a.closest("table");return b.find("tr[data-parent='"+a.data("id")+"']")},c=function(b){var d=g(b);d.length&&d.hide().each(function(){var b=a(this);g(b).length&&c(b)})},d=function(a){var d=a.find(".tree-toggler"),e=a.data("open");d.toggleClass("fa-caret-right"),d.toggleClass("fa-caret-down"),e?c(a):b(a),a.data("open",!e)},e=function(b){return a.inArray(b.nodeName,["A","INPUT","BUTTON","TEXTAREA","SELECT"])>=0||a(b).parents("a:first,input:first,button:first,textarea:first,select:first").length||a(b).data("toggle")},g=function(a){return"undefined"==typeof a.data("children")&&a.data("children",calculateChildren(a)),a.data("children")},this.each(function(){var b=a(this),c=b.find("tr.selected:first");if(b.on("click",".tree-toggler",function(b){b.preventDefault();var c=a(this),e=c.closest("tr");d(e)}),b.on("keydown","tbody > tr","left",function(b){b.stopPropagation();var c=a(this);c.data("open")&&d(c)}),b.on("keydown","tbody > tr","return",function(b){if(!e(b)){var c=a(this).find("a:first");c.length&&(b.stopPropagation(),b.preventDefault(),c.get(0).click())}}),b.on("keydown","tbody > tr","right",function(b){b.stopPropagation();var c=a(this);c.data("open")||d(c)}),b.sortable({items:"tbody > tr",handle:".sortable-handle"}),c.length){for(var f=b.find("tr[data-id='"+(c.data("parent")||"")+"']");f.length;)d(f),f=b.find("tr[data-id='"+(f.data("parent")||"")+"']");d(c),c.focus(),c.blur(function(){a(this).removeClass("selected")})}else d(b.find("tr[data-has-children='true']").first())})},a(".tree-table").treeTable()}(presideJQuery);
//# sourceMappingURL=_sitetree.min.map