!function(a){var b=a("#add-assets-form"),c=a("#file-preview-template");if(b.length&&c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=c.get(0).innerHTML,r=a("#upload-previews"),s=0,t=0,u=0,v=1,w=2;c.remove(),e=function(b){b.previewElement=a(Mustache.render(q,{name:b.name,size:d.filesize(b.size),type:b.type})).get(0),r.append(b.previewElement),a(b.previewElement).data("file",b),m()},f=function(b){a(b.previewElement).fadeOut(200,function(){a(this).remove()}),m()},n=function(b,c){a(b.previewElement).find("img.preview-thumbnail").attr("src",c)},g=function(){var b=a(this).closest(".asset-preview"),c=b&&b.data("file");return"undefined"!=typeof c&&d.removeFile(c),!1},h=function(){var c,e,f,g,h=d.getFilesWithStatus(Dropzone.ADDED),i=0;if(h.length){for(p=b.serializeObject(),s=0,t=0,d.enqueueFiles(h),g=0;g<h.length;g++)c=a(h[g].previewElement),e=c.find("input[ name='asset-title' ]"),f=e.val(),i=i||e.width(),a.trim(f).length||(f=h[g].name),c.find(".upload-detail").html('<div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" style="width:'+i+'px;"><span class="progress-bar-placeholder">'+f+'</span><div class="progress-bar progress-bar-success" style="width:0%;"></div></div>');b.find("li[data-step='1']").addClass("complete").removeClass("active"),b.find("li[data-step='2']").addClass("active"),b.find(".upload-options").fadeOut(200,function(){a(this).remove(),b.find(".upload-progress").removeClass("hide")})}return!1},i=function(b,c,d){var e=a(b.previewElement),f=e.find(".progress-bar");f.width(c+"%")},j=function(a){$progressBar=b.find(".total-progress .progress-bar"),$progressBar.width(a+"%")},l=function(b,c,d){var e=a(b.previewElement),f=e.find(".upload-detail");s++,f.html(i18n.translateResource("cms:assetmanager.upload.failure.http.message",{data:[d.status+" "+d.statusText]})),e.addClass("upload-error"),e.find(".action-buttons").html('<i class="fa fa-fw fa-ban bigger-130 red"></i>')},successHandler=function(a,b){t++},m=function(){r.find("tr.asset-preview").length?(b.find(".no-files-chosen-message").hide(),b.find(".upload-files-trigger").removeAttr("disabled")):(b.find(".no-files-chosen-message").show(),b.find(".upload-files-trigger").attr("disabled","disabled"))},k=function(){b.find(".upload-progress").fadeOut(200,function(){a(this).remove();var c,d="undefined"!=typeof p.asset_folder?p.asset_folder:"",e=o(),f=[".complete-success",".partial-success",".complete-failure"],g=b.find(".return-to-folder-link"),h=b.find(".start-over-link");for(f.splice(e,1),c=0;c<f.length;c++)b.find(f[c]).remove();g.attr("href",g.attr("href")+d),h.attr("href",h.attr("href")+d),b.find(".upload-results").removeClass("hide")}),b.find("li[data-step='2']").addClass("complete").removeClass("active"),b.find("li[data-step='3']").addClass("active")},o=function(){return s>0&&t>0?v:t>0?u:w},d=new Dropzone(a("body").get(0),{url:b.attr("action"),thumbnailWidth:50,thumbnailHeight:50,parallelUploads:1,autoQueue:!1,clickable:".choose-files-trigger",addedfile:e,thumbnail:n,uploadprogress:i,totaluploadprogress:j,queuecomplete:k,error:l}),b.on("click",".cancel-file-trigger",g),b.on("click",".upload-files-trigger",h)}}(presideJQuery);
//# sourceMappingURL=_uploadAssets.min.map